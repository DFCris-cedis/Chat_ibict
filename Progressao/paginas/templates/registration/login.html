{% comment %} <!DOCTYPE html>
<html>
    <head>
        <title>Contextus</title>
        <link rel="stylesheet" href="/static/css/login.css" />
</head>
<body>
    <div class="container">

        <div class="coluna_1">
            <img src="/static/img/contextus2.png" alt="chatibict" class="imagem" />
        </div>
    
        <div class="coluna_2">
            <div class="title"><h1>BEM-VINDO(A)!</h1></div>
    
            <div class="inner-box">
                <form method="post" action="{% url 'login' %}" class="form" id="login-form">
                    <div class="title"><h2>Login</h2></div>
        {% csrf_token %}
        {{ form.as_p }}
        
        <button type="submit">ENTRAR</button>
            </form>
        </div>
        
        <div class="link">
            <a href="{% url 'signup' %}">Não tem uma conta? Cadastre-se aqui</a>
            <p>
            <a href="{% url 'password_reset' %}">Esqueceu a sua senha?</a>
            </p>
        </div>
    </div>



</body>
</html> {% endcomment %}

<!DOCTYPE html>
<html>
    <head>
        <title>Contextus</title>
        <link rel="stylesheet" href="/static/css/login.css" />
        <style>
            .popup-erro {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                display: none;
            }

            .popup-conteudo {
                background: #fff;
                padding: 20px;
                border-radius: 5px;
                text-align: center;
            }

            .popup-fechar {
                position: absolute;
                top: 10px;
                right: 15px;
                font-size: 20px;
                cursor: pointer;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="coluna_1">
                <img src="/static/img/contextus2.png" alt="chatibict" class="imagem" />
            </div>
        
            <div class="coluna_2">
                <div class="title"><h1>BEM-VINDO(A)!</h1></div>
        
                <div class="inner-box">
                    <form method="post" action="{% url 'login' %}" class="form" id="login-form">
                        <div class="title"><h2>Login</h2></div>
                        {% csrf_token %}
                        {{ form.as_p }}
                        
                        <button type="submit">ENTRAR</button>
                    </form>
                </div>
                
                <div class="link">
                    <a href="{% url 'signup' %}">Não tem uma conta? Cadastre-se aqui</a>
                    <p><a href="{% url 'password_reset' %}">Esqueceu a sua senha?</a></p>
                </div>
            </div>
        </div>

        <div id="popupErro" class="popup-erro">
            <div class="popup-conteudo">
                <span class="popup-fechar" onclick="fecharPopupErro()">&times;</span>
                <p id="textoErroPopup"></p>
            </div>
        </div>
    
        <script>
            document.getElementById('login-form').addEventListener('submit', function(event) {
                event.preventDefault();
                var formData = new FormData(this);
                fetch("{% url 'login' %}", {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': formData.get('csrfmiddlewaretoken')
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Resposta de rede não foi ok.');
                    }
                    window.location.href = response.url; // Redireciona para a URL recebida na resposta
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById("textoErroPopup").textContent = 'Ocorreu um erro ao processar o login.';
                    document.getElementById("popupErro").style.display = "flex";
                });
                
    
            function fecharPopupErro() {
                document.getElementById("popupErro").style.display = "none";
            }
        </script>
    </body>
    </html>